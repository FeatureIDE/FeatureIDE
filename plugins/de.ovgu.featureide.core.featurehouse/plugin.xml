<?xml version="1.0" encoding="UTF-8"?>
<?eclipse version="3.4"?>
<plugin>
	<extension
			point="de.ovgu.featureide.core.composers">
		<composer
				class="de.ovgu.featureide.featurehouse.FeatureHouseComposer"
				description="Feature-oriented programming for several structured file types (e.g. Java 1.5)."
				id="de.ovgu.featureide.composer.featurehouse"
				name="FeatureHouse"
				nature="FeatureIDE_Core.featureHouseNature">
		</composer>
	</extension>
	<extension
			point="org.eclipse.ui.menus">
		<menuContribution locationURI="popup:de.ovgu.featureide.fm.ui.menus.popupMenu?before=de.ovgu.featureide.fm.ui.menus.popupMenu.submenus">
			<menu
         icon="icons/FeatureIconSmall.ico"
         id="de.ovgu.featureide.featurehouse.ui.submenu"
         label="FeatureHouse">
				<visibleWhen
						checkEnabled="false">
					<with
							variable="activeMenuSelection">
						<iterate
								ifEmpty="false"
								operator="or">
							<test
									args="de.ovgu.featureide.composer.featurehouse"
									property="de.ovgu.featureide.fm.ui.properties.composer">
							</test>
						</iterate>
					</with>
				</visibleWhen>
				<command
						commandId="de.ovgu.featureide.core.featurehouse.ui.commands.metaproduct"
						id="de.ovgu.featureide.core.featurehouse.ui.actions.meatproduct"
						label="Build Metaproduct"
						style="toggle">
					<visibleWhen
							checkEnabled="false">
						<with
								variable="activeMenuSelection">
							<and>
								<count
										value="1">
								</count>
								<reference
										definitionId="de.ovgu.featureide.ui.expressions.onlyProjects">
								</reference>
								<test
										args="de.ovgu.featureide.core.featurehouse.ui.commands.metaproduct"
										property="de.ovgu.featureide.core.featurehouse.properties.toggle.metaproduct">
								</test>
							</and>
						</with>
					</visibleWhen>
				</command>
				<command
						commandId="de.ovgu.featureide.core.featurehouse.ui.commands.fuji"
						id="de.ovgu.featureide.core.featurehouse.ui.actions.fuji"
						label="Enable Fuji Type Check"
						style="toggle">
					<visibleWhen
							checkEnabled="false">
						<with
								variable="activeMenuSelection">
							<and>
								<count
										value="1">
								</count>
								<reference
										definitionId="de.ovgu.featureide.ui.expressions.onlyProjects">
								</reference>
							</and>
						</with>
					</visibleWhen>
				</command>
				<command
						commandId="de.ovgu.featureide.core.featurehouse.ui.commands.key"
						id="de.ovgu.featureide.core.featurehouse.ui.actions.key"
						label="Perform Feature-Based Verification with KeY"
						tooltip="Generates Feature Stubs and Starts KeY for each Feature Stub&apos;s Verification"
						style="push">
					<visibleWhen
							checkEnabled="false">
						<with
								variable="activeMenuSelection">
							<and>
								<count
										value="1">
								</count>
								<reference
										definitionId="de.ovgu.featureide.ui.expressions.onlyProjects">
								</reference>
							</and>
						</with>
					</visibleWhen>
				</command>
			</menu>
		</menuContribution>
  <menuContribution
        allPopups="false"
        locationURI="popup:#CompilationUnitEditorContext?after=additions">
    <!--
     <menu
           label="Refactoring">
           -->
        <menu
              label="FeatureHouse-Refactoring">
           <command
                 commandId="de.ovgu.featureide.core.featurehouse.ui.commands.refactoring.rename"
                 id="de.ovgu.featureide.core.featurehouse.ui.action.refactoring.rename"
                 label="Rename..."
                 style="push">
              <visibleWhen
                    checkEnabled="false">
                 <test
                       property="de.ovgu.featureide.core.featurehouse.properties.rename">
                 </test>
              </visibleWhen>
           </command>
           <command
                 commandId="de.ovgu.featureide.core.featurehouse.ui.commands.refactoring.pullUp"
                 id="de.ovgu.featureide.core.featurehouse.ui.action.refactoring.pullup"
                 label="Pull Up To Parent Feature..."
                 style="push">
              <visibleWhen
                    checkEnabled="false">
                 <test
                       property="de.ovgu.featureide.core.featurehouse.properties.rename">
                 </test>
              </visibleWhen>
           </command>
        </menu>
     <!--</menu>-->
  </menuContribution>
  <menuContribution
        allPopups="false"
        locationURI="popup:de.ovgu.featureide.ui.views.collaboration.outline.CollaborationOutline">
     <menu
           label="FeatureHouse-Refactoring">
        <command
              commandId="de.ovgu.featureide.core.featurehouse.ui.commands.refactoring.rename"
              id="de.ovgu.featureide.core.featurehouse.ui.action.refactoring.rename"
              label="Rename..."
              style="push">
           <visibleWhen
                 checkEnabled="false">
              <test
                    property="de.ovgu.featureide.core.featurehouse.properties.rename">
              </test>
           </visibleWhen>
        </command>
        <command
              commandId="de.ovgu.featureide.core.featurehouse.ui.commands.refactoring.pullUp"
              label="Pull Up To Parent-Feature..."
              style="push">
           <visibleWhen
                 checkEnabled="false">
              <test
                    property="de.ovgu.featureide.core.featurehouse.properties.rename">
              </test>
           </visibleWhen>
        </command>
     </menu>
  </menuContribution>
  <menuContribution
        locationURI="popup:de.ovgu.featureide.fm.ui.menus.popupMenu">
     <menu
           label="FeatureHouse-Refactoring">
        <visibleWhen
              checkEnabled="false">
           <with
                 variable="activeMenuSelection">
              <iterate
                    ifEmpty="false"
                    operator="or">
                 <test
                       args="de.ovgu.featureide.composer.featurehouse"
                       property="de.ovgu.featureide.fm.ui.properties.composer">
                 </test>
              </iterate>
           </with>
        </visibleWhen>
        <command
              commandId="de.ovgu.featureide.core.featurehouse.ui.commands.refactoring.pullUpAllClonedMembers"
              label="PullUp cloned Members"
              style="push">
           <visibleWhen
                 checkEnabled="false">
              <with
                    variable="activeMenuSelection">
                 <and>
                    <count
                          value="1">
                    </count>
                    <reference
                          definitionId="de.ovgu.featureide.ui.expressions.onlyProjects">
                    </reference>
                    <test
                          args="de.ovgu.featureide.core.featurehouse.ui.commands.fuji"
                          property="de.ovgu.featureide.core.featurehouse.properties.toggle.fuji">
                    </test>
                 </and>
              </with>
           </visibleWhen>
        </command>
     </menu>
  </menuContribution>
	</extension>
	<extension
			point="org.eclipse.ui.commands">
		<command
				id="de.ovgu.featureide.core.featurehouse.ui.commands.metaproduct"
				name="Build Metaproduct">
			<state
					class="org.eclipse.jface.commands.ToggleState"
					id="org.eclipse.ui.commands.toggleState">
			</state>
		</command>
		<command
				id="de.ovgu.featureide.core.featurehouse.ui.commands.fuji"
				name="Enable Fuji Type Check">
			<state
					class="org.eclipse.jface.commands.ToggleState"
					id="org.eclipse.ui.commands.toggleState">
			</state>
		</command>
		<command
				id="de.ovgu.featureide.core.featurehouse.ui.commands.key"
				name="Perform Feature-Based Verification with KeY">
		</command>
  <command
        id="de.ovgu.featureide.core.featurehouse.ui.commands.refactoring.rename"
        name="Rename">
  </command>
  <command
        id="de.ovgu.featureide.core.featurehouse.ui.commands.refactoring.pullUp"
        name="PullUp">
  </command>
	</extension>
	<extension
			point="org.eclipse.ui.handlers">
		<handler
				class="de.ovgu.featureide.featurehouse.ui.handlers.BuildMetaProductHandler"
				commandId="de.ovgu.featureide.core.featurehouse.ui.commands.metaproduct">
		</handler>
		<handler
				class="de.ovgu.featureide.featurehouse.ui.handlers.EnableFujiHandler"
				commandId="de.ovgu.featureide.core.featurehouse.ui.commands.fuji">
		</handler>
		<handler
				class="de.ovgu.featureide.featurehouse.ui.handlers.GenerateFeatureStubsHandler"
				commandId="de.ovgu.featureide.core.featurehouse.ui.commands.key">
		</handler>
  <handler
        class="de.ovgu.featureide.featurehouse.ui.handlers.RenameHandler"
        commandId="de.ovgu.featureide.core.featurehouse.ui.commands.refactoring.rename">
  </handler>
  <handler
        class="de.ovgu.featureide.featurehouse.ui.handlers.PullUpHandler"
        commandId="de.ovgu.featureide.core.featurehouse.ui.commands.refactoring.pullUp">
  </handler>
	</extension>
	<extension
			id="de.ovgu.featureide.featurehouse.meta.verificationmarker"
			name="Verifikation Marker"
			point="org.eclipse.core.resources.markers">
		<super
				type="org.eclipse.core.resources.problemmarker">
		</super>
		<persistent
				value="true">
		</persistent>
	</extension>
	<extension
			point="org.eclipse.core.expressions.propertyTesters">
		<propertyTester
				class="de.ovgu.featureide.featurehouse.ui.handlers.toggle.FujiTester"
				id="de.ovgu.featureide.core.featurehouse.toggleTester.fuji"
				namespace="de.ovgu.featureide.core.featurehouse.properties.toggle"
				properties="fuji"
				type="org.eclipse.jface.viewers.IStructuredSelection">
		</propertyTester>
		<propertyTester
				class="de.ovgu.featureide.featurehouse.ui.handlers.toggle.MetaProductTester"
				id="de.ovgu.featureide.core.featurehouse.toggleTester.metaproduct"
				namespace="de.ovgu.featureide.core.featurehouse.properties.toggle"
				properties="metaproduct"
				type="org.eclipse.jface.viewers.IStructuredSelection">
		</propertyTester>
  <propertyTester
        class="de.ovgu.featureide.featurehouse.ui.properties.RenameTester"
        id="de.ovgu.featureide.core.featurehouse.renamepropertyTester"
        namespace="de.ovgu.featureide.core.featurehouse.properties"
        properties="rename"
        type="java.lang.Object">
  </propertyTester>
	</extension>
</plugin>
